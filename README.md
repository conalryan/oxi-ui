# OxiUI

OxiUI Front-End library generated by AI - A modern monorepo using Bun + Vite + OXC.

## Overview

OxiUI is a frontend monorepo that provides:

- **@oxi-ui/core** - Core TypeScript library with authentication, feature flags, permissions, and utilities
- **@oxi-ui/web-components** - Lit-based web components with React and Angular wrappers

## Quick Start

```bash
# Install dependencies
bun install

# Build all packages
bun run build

# Run tests
bun run test

# Run tests with coverage
bun run test:coverage

# Lint code
bun run lint

# Format code
bun run format
```

## Packages

### @oxi-ui/core

Core utilities library with tree-shakable exports:

```typescript
// Import specific modules
import { isAuthorized } from "@oxi-ui/core/authentication";
import { isEnabled } from "@oxi-ui/core/feature-flags";
import { hasPermission } from "@oxi-ui/core/permissions";
import { debounce, throttle } from "@oxi-ui/core/utils";

// Or import everything
import { isAuthorized, isEnabled, hasPermission, debounce } from "@oxi-ui/core";
```

#### Authentication

```typescript
import { isAuthorized } from "@oxi-ui/core/authentication";

const session = {
  userId: "user-123",
  roles: ["admin", "user"],
  expiresAt: "2026-12-31T23:59:59Z",
  permissions: ["read", "write"],
};

const result = isAuthorized(session, {
  requiredRoles: ["admin"],
  requiredPermissions: ["read"],
});

if (result.authorized) {
  // User has access
}
```

#### Feature Flags

```typescript
import { initializeFeatureFlags, isEnabled } from "@oxi-ui/core/feature-flags";

initializeFeatureFlags([
  { id: "new-dashboard", name: "New Dashboard", enabled: true },
  { id: "beta-feature", name: "Beta", enabled: true, rolloutPercentage: 50 },
]);

if (isEnabled("new-dashboard")) {
  // Show new dashboard
}

if (isEnabled("beta-feature", { userId: "user-123" })) {
  // Show beta feature (50% rollout)
}
```

### @oxi-ui/web-components

Lit-based web components with framework wrappers:

#### Web Components (Vanilla JS/HTML)

```html
<script type="module">
  import '@oxi-ui/web-components';
</script>

<oxi-button variant="primary" size="medium">Click me</oxi-ui-button>

<oxi-text-field
  label="Email"
  type="email"
  placeholder="Enter your email"
  required
></oxi-ui-text-field>
```

#### React

```tsx
import { OxiButton, OxiTextField } from "@oxi-ui/web-components/react";

function App() {
  const [email, setEmail] = useState("");

  return (
    <>
      <OxiButton variant="primary" onClick={() => console.log("clicked")}>
        Submit
      </OxiButton>

      <OxiTextField
        label="Email"
        type="email"
        value={email}
        onInput={(e) => setEmail(e.detail.value)}
      />
    </>
  );
}
```

#### Angular

```typescript
import { OxiComponentsModule } from "@oxi-ui/web-components/angular";

@NgModule({
  imports: [OxiComponentsModule],
})
export class AppModule {}
```

```html
<oxi-button-wrapper variant="primary" (oxi-uiClick)="handleClick($event)">
  Submit
</oxi-button-wrapper>

<oxi-text-field-wrapper
  label="Email"
  type="email"
  [value]="email"
  (oxi-uiInput)="onEmailInput($event)"
>
</oxi-text-field-wrapper>
```

## Development

### Build a specific package

```bash
bun run build:core
bun run build:web-components
```

### Test a specific package

```bash
bun run test:core
bun run test:web-components
```

### Package Scripts

Each package supports:

- `build` - Build the package with Vite
- `test` - Run tests with Bun
- `test:coverage` - Run tests with coverage
- `clean` - Remove dist and coverage directories
- `typecheck` - Run TypeScript type checking

## Architecture

### Monorepo Structure

```
oxi-ui/
├── package.json          # Root workspace config
├── bunfig.toml          # Bun configuration
├── tsconfig.json        # Base TypeScript config
├── packages/
│   ├── core/            # @oxi-ui/core
│   │   ├── src/
│   │   │   ├── authentication/
│   │   │   ├── feature-flags/
│   │   │   ├── permissions/
│   │   │   └── utils/
│   │   └── vite.config.ts
│   └── web-components/  # @oxi-ui/web-components
│       ├── src/
│       │   ├── button/
│       │   ├── text-field/
│       │   ├── react/
│       │   └── angular/
│       └── vite.config.ts
└── prompts/             # AI generation prompts
```

### Technology Stack

- **Runtime**: [Bun](https://bun.sh) - Fast JavaScript runtime and package manager
- **Build System**: [Turborepo](https://turbo.build) - Monorepo build orchestration with caching
- **Bundler**: [Vite](https://vitejs.dev) - Next-generation frontend tooling
- **Versioning**: [Changesets](https://github.com/changesets/changesets) - Version management and publishing
- **Linting**: [OXLint](https://oxc-project.github.io/docs/guide/usage/linter.html) - Fast Rust-based linter
- **Web Components**: [Lit](https://lit.dev) - Simple, fast web components
- **Testing**: Bun test runner with built-in coverage

### Key Features

- ✅ Independent package versioning, building, testing, and publishing
- ✅ Caching - only necessary tasks run
- ✅ Parallel task execution with dependency resolution
- ✅ Tree-shakable exports for optimal bundle size
- ✅ Minification and production-ready builds
- ✅ 90%+ code coverage target
- ✅ TypeScript with strict mode
- ✅ Framework-agnostic web components
- ✅ React and Angular wrapper components

## Docker

### Development with Docker

Run the full CI pipeline locally:

```bash
# Run all checks (lint, test, build)
./scripts/ci-local.sh all

# Run only on affected packages
./scripts/ci-local.sh all --affected

# Or run individual steps
./scripts/ci-local.sh lint
./scripts/ci-local.sh test
./scripts/ci-local.sh build
```

### Docker Targets

The Dockerfile supports multiple build targets:

```bash
# Development environment (default)
docker build --target development -t oxi-ui-dev .

# Run tests
docker build --target test -t oxi-ui-test .

# Run linting
docker build --target lint -t oxi-ui-lint .

# Full CI pipeline
docker build --target ci -t oxi-ui-ci .

# Production (built packages only)
docker build --target production -t oxi-ui-prod .
```

### VS Code Dev Container

Open this repository in VS Code and use the "Reopen in Container" command for a fully configured development environment with:

- Bun runtime and package manager
- All VS Code extensions pre-installed
- Port forwarding for development servers
- Persistent node_modules and Bun cache volumes

## CI/CD

### Tools

- **[Turborepo](https://turbo.build)** - Monorepo build system with caching and change detection
- **[Changesets](https://github.com/changesets/changesets)** - Versioning, changelogs, and publishing

### Pipeline Features

- **Change Detection** - Turborepo's `--affected` flag only runs tasks on changed packages
- **Caching** - Turborepo caches build outputs for faster CI runs
- **Automatic Versioning** - Changesets handles semver and changelog generation
- **Independent Semver** - Each package maintains its own version

### Pipeline Stages

1. **Install** - Install dependencies with `bun install`
2. **Quality** - Lint and format check (parallel)
3. **Test** - Run tests with coverage on affected packages
4. **Build** - Build affected packages with Turborepo
5. **Release** - Version and publish via Changesets (main branch only)

### Versioning with Changesets

When making changes that should be released:

```bash
# Create a changeset (interactive prompt)
bunx changeset

# This creates a markdown file in .changeset/ describing your change
# Commit this file with your PR
```

Changesets will prompt you to:
1. Select which packages are affected
2. Choose the version bump type (major/minor/patch)
3. Write a summary of the change

### Releasing

```bash
# Apply pending changesets (updates versions and generates changelogs)
bun run version

# Full release: version + build + publish to npm
bun run release
```

On CI (main branch), the pipeline automatically runs:
```bash
bunx changeset version   # Apply changesets
bunx turbo run build     # Build all packages
bunx changeset publish   # Publish to npm + create git tags
```

### Turborepo Commands

```bash
# Build only affected packages
bunx turbo run build --affected

# Build packages changed since main
bunx turbo run build --filter="[origin/main]"

# See what would run (dry run)
bunx turbo run build --affected --dry-run
```

### Jenkins Configuration

Required Jenkins credentials:

- `npm-token` - NPM authentication token for publishing
- `github-ssh-key` - SSH key for pushing tags and version commits

## Documentation

- [Workspace Recommendations](./prompts/WORKSPACE_RECOMMENDATIONS.md)
- [Modern Tooling Recommendations](./prompts/MODERN_TOOLING_RECOMMENDATIONS.md)

## License

MIT
